import{i as w,r as u,u as A,o as F,j as P,a as R,b as n,c as l,d as U,e,w as c,t as g,f as q,v as G,F as C,k as B,g as V,l as H,n as L}from"./index-3b3b4d44.js";import{_ as J}from"./Vector-6ae52742.js";const K="/ViteTodolist/assets/empty1-04331934.png",Q={class:"container p-4 d-flex justify-content-between align-items-center"},W=e("h1",{class:"h2 Baloo-Thambi fw-bold text-center mb-0"},[e("img",{src:J,alt:"Vector_img"}),V(" ONLINE TODO LIST")],-1),X={key:0,class:"header_logout d-flex align-items-center"},Y=["onClick"],Z=["onClick"],ee={key:1,class:"header_logout d-flex align-items-center"},te={class:"h4 d-none d-md-block mb-0 mx-2"},oe=["onClick"],se={key:0,class:"container col-12 col-md-8 col-lg-5 p-4 mx-auto"},ne=["onSubmit"],le=e("button",{class:"search-btn",id:"addTodo_btn",type:"submit"},[e("i",{class:"bi bi-plus-square-fill"})],-1),ie={key:0,class:"empty d-flex flex-column align-items-center mt-3"},ce=e("h2",{class:"h5 pt-6 mt-1"},"目前尚無待辦事項",-1),ae=e("img",{src:K,alt:"empty_img"},null,-1),re=[ce,ae],de={key:1,class:"todoList mt-4"},ue={class:"nav nav_bar nav-fill justify-content-center",id:"list_Bar"},me=["onClick"],_e={class:"content"},he={class:"d-flex align-items-center justify-content-between"},fe={class:"form-check d-flex align-items-center"},pe=["onClick"],ve=["onClick"],ke=["onClick"],ge=e("i",{class:"bi bi-x-lg"},null,-1),xe=[ge],be={class:"d-flex justify-content-between align-items-center p-4"},Ce={class:"item_count"},Te=["onClick"],Le={__name:"TodolistView",setup(ye){const a=w("$swal"),m=w("axios"),x=u(!0),b=A(),_=u(""),h=u(""),j=u(["全部","待完成","已完成"]),v=u("全部"),f="https://todoo.5xcamp.us/",r=u([]),d=u("");function p(){m.get(`${f}todos`).then(t=>{r.value=t.data.todos})}function D(){const t={todo:{content:d.value}};m.post(`${f}todos`,t).then(o=>{a.fire({icon:"success",title:"新增完畢",text:`以新增${o.data.content}`,showConfirmButton:!1,timer:500}),setTimeout(()=>{p()},500)}),d.value=""}function N(){if(d.value===""){a.fire({icon:"error",title:"發生錯誤",text:"你要新增的項目不可為空 !"});return}r.value.some(o=>o.content===d.value.trim())?(a.fire({icon:"error",title:"發生錯誤",text:"此待辦您已輸入過，請重新輸入 !"}),d.value=""):D()}function T(t){m.patch(`${f}todos/${t}/toggle`).then(o=>{p()})}function S(t){a.fire({icon:"warning",title:"刪除清單選項",text:`是否刪除${t.content} 這個清單!`,showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"DELETE!"}).then(o=>{o.isConfirmed&&m.delete(`${f}todos/${t.id}`).then(i=>{a.fire({icon:"success",title:`${i.data.message}成功!`}),p()})})}function E(){const t=r.value.filter(i=>i.completed_at!==null).map(i=>i.id);if(t.length===0)return;const o=t.map(i=>m.delete(`${f}todos/${i}`));Promise.all(o).then(()=>{p(),a.fire({icon:"success",title:"刪除完畢",showConfirmButton:!1,timer:1500})})}function I(){_.value!==""?(m.defaults.headers.common.Authorization=_.value,p()):(a.fire({icon:"error",title:"登入錯誤",text:"登入時間過時或還未登入",showConfirmButton:!1,timer:1500}),setTimeout(()=>{b.push("/")},1500))}function y(){b.push("/")}function M(){b.push("/signUp")}function O(t){v.value=t}F(()=>{_.value=document.cookie.replace(/(?:(?:^|.*;\s*)todoToken\s*=\s*([^;]*).*$)|^.*$/,"$1"),h.value=document.cookie.replace(/(?:(?:^|.*;\s*)username\s*=\s*([^;]*).*$)|^.*$/,"$1"),setTimeout(()=>{x.value=!1},1500),I()});const $=P(()=>v.value==="全部"?r.value:v.value==="待完成"?r.value.filter(i=>i.completed_at===null):r.value.filter(o=>o.completed_at!==""&&o.completed_at!==null));function z(){a.fire({icon:"success",title:"使用者登出",text:`感謝${h.value}的使用~`,showConfirmButton:!1,timer:1500}),setTimeout(()=>{_.value="",h.value="",document.cookie="todoToken=;  max-age=0",document.cookie="username=; max-age=0",y()},1500)}return(t,o)=>{const i=R("VueLoading");return n(),l(C,null,[U(i,{active:x.value},null,8,["active"]),e("header",Q,[W,(_.value&&h.value)===""?(n(),l("div",X,[e("a",{href:"index.html",class:"me-3 text-dark fs-md-4",id:"login",onClick:c(y,["prevent"])},"登入",8,Y),e("a",{href:"index.html",class:"text-dark fs-md-4",id:"register",onClick:c(M,["prevent"])},"註冊",8,Z)])):(n(),l("div",ee,[e("h2",te,g(h.value)+"的代辦",1),e("a",{href:"index.html",class:"text-dark fs-md-4",id:"register",onClick:c(z,["prevent"])},"登出",8,oe)]))]),x.value?H("",!0):(n(),l("main",se,[e("form",{class:"search-bar",id:"searchBar",onSubmit:c(N,["prevent"])},[q(e("input",{type:"text",id:"todoInput",class:"form-control p-3",placeholder:"新增待辦事項","onUpdate:modelValue":o[0]||(o[0]=s=>d.value=s)},null,512),[[G,d.value]]),le],40,ne),r.value.length===0?(n(),l("div",ie,re)):(n(),l("div",de,[e("ul",ue,[(n(!0),l(C,null,B(j.value,(s,k)=>(n(),l("li",{class:L(["options",{active:v.value===s}]),key:"category"+k,onClick:c($e=>O(s),["prevent"])},g(s),11,me))),128))]),e("div",_e,[(n(!0),l(C,null,B($.value,s=>(n(),l("ul",{class:"list px-0",id:"list_items",key:s.id},[e("li",he,[e("div",fe,[s.completed_at===null?(n(),l("input",{key:0,type:"checkbox",class:"form-check-input ms-2 me-3",onClick:c(k=>T(s.id),["prevent"])},null,8,pe)):(n(),l("i",{key:1,class:"bi bi-check-lg",onClick:c(k=>T(s.id),["prevent"])},null,8,ve)),e("label",{class:L(["form-check-label mt-1",{active:s.completed_at!==null}])},g(s.content),3)]),e("button",{class:"btn-delete",onClick:c(k=>S(s),["prevent"])},xe,8,ke)])]))),128))]),e("div",be,[e("div",Ce,[e("span",null,g($.value.length),1),V("個待完成項目")]),e("a",{href:"#",class:"clear",onClick:c(E,["prevent"])},"清除已完成項目",8,Te)])]))]))],64)}}};export{Le as default};
